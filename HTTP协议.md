# HTTP协议

### 简介

超文本传输协议，完成从客户端 --》服务器等一系列运作流程。

模型：请求/响应模型

状态：无状态。协议本身对于请求或者响应不进行状态保存。因此，产生了Cookie技术 --- 客户端状态管理

请求内容：{ 方法、URL、协议版本、请求头部、请求数据 }

响应内容：{ 协议版本、成功或者失败代码、服务器信息、响应头部、响应数据 }

### TCP/IP协议族

HTTP协议只是它的一个子集。

按层次分为四层，如下：

##### 1. 应用层

规定了向用户提供应用服务时，通信的协议，例如 FTP（文件传输），DNS（域名解析），HTTP（超文本传输）

##### 2. 传输层

处于两台计算机之间的数据传输所使用的协议

协议：TCP协议、UDP协议

TCP协议：全双工，发送与接受数据是同步。三次握手、四次挥手

UDP协议：无连接。更加高效和轻便

##### 3. 网络层

数据通过怎么样的传输路线到对方计算机，IP协议

##### 4. 链路层

处理网络的硬件部分，包括控制操作系统、硬件的设备驱动、NIC，以及光纤等物理可见部分

**注：每经过一层，都会被打上一个该层所属的首部信息**

链接方式：1. 串行连接；2. 持久连接；3. 管道化持久连接；4. http 2.0多路复用；5. websocket

### URI

URI ---- 统一资源标识符；

URL ---- 统一资源定位符；

URN ---- 统一资源名称；

### 版本

##### 1.0

每次请求都会打开一个新的TCP连接，收到响应之后立即断开连接。

##### 1.1

1. 引入缓存控制策略
2. 允许范围请求，在请求头加入Range
3. 请求/响应消息都必须包含HOST头部，以区分同一个物理主机的不同虚拟主机的域名
4. 默认开启持久连接

##### 2.0

帧（frame）和流（stream）

帧，每帧都有序列标识表明属于哪个流

流，由多个帧组成的数据流，每个流表示一个请求

**头部压缩**：encoder来减少需要传输的头部大小，通讯双方各自cached一份头部fields表，避免重复头部的传输，又减少了需要传输的大小。

**服务端推送**：把需要的css，js

### 报文

用于http交互的信息 -- http报文

请求报文：

![image-20211206145331638](C:\Users\zhenghuaqing5\AppData\Roaming\Typora\typora-user-images\image-20211206145331638.png)

响应报文：

![image-20211206145447921](C:\Users\zhenghuaqing5\AppData\Roaming\Typora\typora-user-images\image-20211206145447921.png)

### 请求方法

GET --- 获取服务器资源

POST --- 用于传输实体主体

PUT --- 传输文件

DELETE -- 删除文件

HEAD --- 获取报文头部，不返回报文主体

OPTIONS --- 用于询问URI资源支持的方法

### 状态码

2XX -- 成功；

3XX -- 重定向（浏览器需要进行特殊处理）

![image-20211206184820802](C:\Users\zhenghuaqing5\AppData\Roaming\Typora\typora-user-images\image-20211206184820802.png)

4XX -- 客户端错误

![image-20211206184921756](C:\Users\zhenghuaqing5\AppData\Roaming\Typora\typora-user-images\image-20211206184921756.png)

5XX -- 服务器错误

![image-20211206185007328](C:\Users\zhenghuaqing5\AppData\Roaming\Typora\typora-user-images\image-20211206185007328.png)

### 首部字段

##### Cache-Control

缓存行为控制

##### Connection

浏览器链接类型（keep-alive：持久连接）

##### User-Agent

客户端信息

##### 跨域请求

简单请求，复杂请求

简单请求：

​    添加Origin字段  

​    -----**发送后端**-----》

​    服务器接收到，做出对应处理 

​    -----**返回前端**----》

​    浏览器检查响应头是否允许跨域 

​    ------**允许**----》

​    通过，否则抛出错误信息

复杂请求：

​    在发送正式请求之前，浏览器预先发送一个options，进行预检请求

### WEB服务器

##### HTTP/1.1

允许一台HTTP服务器搭建多个WEB站点

##### 代理服务器

正向代理：隐藏用户身份；

反向代理：隐藏服务器身份；

##### HTTPS

|      | HTTP        | HTTPS                            |
| ---- | ----------- | -------------------------------- |
| 传输   | 运行在TCP之上的明文 | 运行在SSL/TLS上，所有传输内容加密             |
| 连接方式 | 80端口        | 443端口                            |
| 状态   | 无状态         | 由HTTP+SSL协议构建，可以进行加密传输、身份认证，防止劫持 |

### 安全防范

##### XSS攻击

跨站脚本攻击。利用了在html中，注入js代码。

1. 修改浏览器URL导致脚本被注入到页面
2. 通过输入框，将脚本注入数据库；--- 使用xss库的白名单过滤防御

##### CSRF攻击

跨站请求伪造。由服务端解决，预防方式，如下

1. GET请求不对数据进行修改；
2. cookie设置HTTP only
3. 接口设置禁止跨域
4. 请求附带验证信息，验证码

##### 点击劫持

一种视觉欺骗的攻击手段

##### 中间人攻击

HTTPS作为防止中间人攻击的终极手段，引入认证机制解决了客户端和服务端的信任问题，从而比较有效的防止中间人攻击

# 深入理解

注：知识点应用：https://juejin.cn/post/6844904132067885064#heading-8 

### TCP三次握手


